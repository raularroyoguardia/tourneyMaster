<div class="cyber-container">
  <!-- Título de la sección -->
  <div class="section-title main-title">
    <span>Gestió de Mapes</span>
    <div class="title-line"></div>
  </div>

  <!-- Formulario con estilo cyberpunk -->
  <div class="cyber-card">
    <div class="card-content">
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <!-- Nombre del juego -->
          <div class="cyber-form-group">
            <label for="nom" class="cyber-label">Nom</label>
            <div class="cyber-input-wrapper">
              <input type="text" class="cyber-input" id="nom" formControlName="nom" placeholder="Nom">
              <div class="input-glow"></div>
              <div *ngIf="form.get('nom')?.invalid && form.get('nom')?.touched" class="cyber-error">
                <span>Aquest camp és obligatori.</span>
              </div>
            </div>
          </div>

          <!--Modo de Juego-->
          <div class="cyber-form-group">
            <label for="mode_joc_id" class="cyber-label">Joc</label>
            <div class="cyber-input-wrapper">
              <select class="cyber-input cyber-select" id="mode_joc_id" formControlName="mode_joc_id">
                <option value="">Selecciona un mode de joc</option>
                <option *ngFor="let mode of modesJocs" [value]="mode.id">{{ mode.nom }}</option>
              </select>
              <div class="input-glow"></div>
              <div *ngIf="form.get('mode_joc_id')?.invalid && form.get('mode_joc_id')?.touched" class="cyber-error">
                <span>Aquest camp és obligatori.</span>
              </div>
            </div>
          </div>

          <!-- Foto del juego -->
          <div class="cyber-form-group">
            <label for="mapa" class="cyber-label">Mapa</label>
            <div class="cyber-input-wrapper">
              <input type="file" class="cyber-input file-input" id="mapa" (change)="onFileSelected($event)">
              <div class="input-glow"></div>
            </div>
          </div>
        </div>

        <!-- Imágenes -->
        <div class="images-container">
          <!-- Vista previa -->
          <div *ngIf="previewImageUrl" class="image-preview new-image">
            <div class="preview-label">Vista prèvia</div>
            <div class="image-frame">
              <img [src]="previewImageUrl" alt="Vista prèvia">
              <div class="image-glow"></div>
            </div>
          </div>
        </div>

        <!-- Mensaje de error general -->
        <div *ngIf="errorMessage" class="cyber-error-message">
          <span>{{ errorMessage }}</span>
        </div>

        <!-- Botón de envío -->
        <div class="button-container">
          <button type="submit" class="cyber-button submit-btn">
            <span class="btn-content">Crear Mapa</span>
            <span class="btn-glitch"></span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Mapas por Juego -->
  <div class="section-title sub-title">
    <span>Mapes per Joc</span>
    <div class="title-line"></div>
  </div>

  <div class="cyber-card game-maps-container">
    <div class="card-content">
      <div *ngFor="let joc of jocs" class="game-section">
        <h2 class="game-title">{{ joc.nom }}</h2>
        
        <div class="game-modes">
          <div *ngFor="let mode of joc.mode_jocs" class="game-mode">
            <h3 class="mode-title">{{ mode.nom }}</h3>
            
            <div class="mode-maps">
              <div *ngFor="let mapa of mode.mapas" class="map-card">
                <div class="map-image-container">
                  <img [src]="'http://127.0.0.1:8000/uploads/mapes/' + mapa.mapa" alt="{{ mapa.nom }}" class="map-image">
                </div>
                <div class="map-info">
                  <span class="map-name">{{ mapa.nom }}</span>
                  <button class="cyber-button delete-btn" (click)="eliminar(mapa.id)">
                    <span class="btn-content">
                      <i class="fi fi-rr-trash"></i>
                    </span>
                    <span class="btn-glitch"></span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>